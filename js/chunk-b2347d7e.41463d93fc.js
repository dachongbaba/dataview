(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2347d7e"],{"5c24":function(t,e,a){"use strict";(function(t){a("d81d"),a("d3b7"),a("ac1f"),a("1276");var s=a("81b0"),n=a.n(s),i=a("bc3a"),r=a.n(i),l=a("c1df"),c=a.n(l);function o(t,e,a){e.data=a,e.params.page=this.page+e.pages.index,e.params.size=this.size,r()(e).then((function(a){t.datas=n.a.get(a.data,e.paths.dataPath,[]),t.page=1*n.a.get(a.data,e.paths.pagePath,0)-e.pages.index,t.total=1*n.a.get(a.data,e.paths.totalPath,0),t.count=1*n.a.get(a.data,e.paths.countPath,0),t.size=1*n.a.get(a.data,e.paths.sizePath,20)})).catch((function(t){console.error(fetch,t)})).finally((function(){}))}e["a"]={name:"DataTable",props:{fields:{type:Array,default:function(){return[]}},fetchs:{type:Object,default:function(){return{}}},querys:{type:Object,default:function(){return{}}}},data:function(){return{datas:this.fetchs.datas,index:0,page:0,size:20,total:0,count:0,length:0}},watch:{querys:{handler:function(){this.fetchData()},deep:!0}},created:function(){this.index=this.fetchs.pages.page||this.index,this.page=this.fetchs.pages.page||this.page,this.size=this.fetchs.pages.size||this.size;var t=this;this.fields.map((function(e){if(e.format){var a=e.format.split("|"),s=t[a[0]];e.format=function(e){return a[0]=e,s.apply(t,a)}}})),this.fetchData(this,this.fetchs)},computed:{jq:function(){return t},fetch:function(){return n.a.debounce(o,500)}},methods:{fetchData:function(){return this.fetch(this,this.fetchs,this.querys)},resetPage:function(){this.page=this.fetchs.pages.page||0,this.fetchData()},pagePrev:function(){this.page<=0||(this.page-=1,this.fetchData())},pageNext:function(){this.page>=this.total-1||(this.page+=1,this.fetchData())},format:function(t,e){return e.format?e.format(t[e.data]):t[e.data]},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";if(t/=1,!t)return"";var a=new Date(t),s=c()(a).format(e);return s},formatStat:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t/=1,e=JSON.parse(e),e[t]||t||"-"}}}}).call(this,a("c5ec"))},"8840d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.datas?a("div",[t.datas.title?a("h2",[t._v(t._s(t.datas.title))]):t._e(),t.datas.desc?a("p",{staticClass:"text-muted"},[t._v(t._s(t.datas.desc))]):t._e(),a("data-filter",{attrs:{items:t.datas.filters,querys:t.querys},on:{"update:querys":function(e){t.querys=e}}}),a("data-table",{attrs:{fields:t.datas.columns,fetchs:t.datas.fetchs,result:t.result,querys:t.querys},on:{"update:result":function(e){t.result=e}}})],1):t._e()},n=[],i=(a("d81d"),a("96cf"),a("1da1")),r=a("81b0"),l=a.n(r),c=a("bc3a"),o=a.n(c),u=a("db49"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-striped"},[a("thead",[a("tr",{staticClass:"table-secondary"},t._l(t.fields,(function(e){return a("th",{key:e.data},[t._v(" "+t._s(e.title||e.data)+" ")])})),0)]),a("tbody",t._l(t.datas,(function(e,s){return a("tr",{key:s},t._l(t.fields,(function(s,n){return a("td",{key:n},[t._v(" "+t._s(t.format(e,s))+" ")])})),0)})),0)])]),t.total?a("div",{staticClass:"d-flex justify-content-end"},[a("div",{staticClass:"align-self-center"},[t._v(" page: "+t._s(t.page+1)+" / "+t._s(t.total)+", count: "+t._s(t.page*this.size+1)+" - "+t._s(t.page*this.size+t.datas.length)+" / "+t._s(t.count)+" ")]),a("div",{staticClass:"p-1"}),a("div",{staticClass:"align-self-center"},[a("ul",{staticClass:"pagination m-0"},[a("li",{staticClass:"page-item",class:{disabled:t.page<=0}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.pagePrev(e)}}},[a("i",{staticClass:"fa fa-chevron-left"})])]),a("li",{staticClass:"page-item",class:{disabled:t.page>=t.total-1}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.pageNext(e)}}},[a("i",{staticClass:"fa fa-chevron-right"})])])])])]):t._e()])},d=[],p=a("5c24"),h=p["a"],g=a("2877"),m=Object(g["a"])(h,f,d,!1,null,"5ed801d1",null),v=m.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"border rounded-left rounded-right"},[a("ul",{staticClass:"nav mt-0 mb-0 align-self-center",staticStyle:{width:"100%"}},[t._l(t.filters,(function(e,s){return[e.datetime?a("li",{key:s,staticClass:"nav-item p-1 align-self-center"},[a("a",{staticClass:"btn bg-light d-flex h-100"},[a("span",{staticClass:"align-self-center mr-1"},[t._v(t._s(e.label)+":")]),a("datetime",{staticClass:"align-self-center mr-1",attrs:{"input-class":"border-0",type:e.datetime.type||"date","input-style":{"background-color":"transparent",width:e.datetime.width||"120px"}},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"filter.value"}}),a("span",{staticClass:"align-self-center fa fa-remove p-1",on:{click:function(e){return e.preventDefault(),t.removeFilter(s)}}})],1)]):e.fetchs?a("li",{key:s,staticClass:"nav-item dropdown p-1 align-self-center"},[a("a",{staticClass:"btn bg-light d-flex h-100",attrs:{href:"#","data-toggle":"dropdown"}},[a("span",{staticClass:"align-self-center mr-1"},[t._v(t._s(e.label)+":")]),a("span",{staticClass:"align-self-center mr-1"},[t._v(t._s(e.text))]),a("span",{staticClass:"align-self-center fa fa-remove p-1",on:{click:function(e){return e.preventDefault(),t.removeFilter(s)}}})]),a("div",{staticClass:"dropdown-menu",class:{show:e.show},staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"input-group p-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"filter.query"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search"},domProps:{value:e.query},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchFilter(e)},input:function(a){a.target.composing||t.$set(e,"query",a.target.value)}}})]),a("div",{staticStyle:{height:"300px","overflow-y":"auto"}},t._l(e.datas,(function(n,i){return a("a",{key:i,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.setFilterValue(s,e,n,n[e.fetchs.paths.label||e.fetchs.paths.title||e.fetchs.paths.title.id])}}},[e.fetchs.paths.icon?a("img",{staticClass:"img-thumbnail rounded-circle mr-1",attrs:{src:n[e.fetchs.paths.icon],width:"25"}}):t._e(),a("b",{staticClass:"p-1"},[t._v(t._s(n[e.fetchs.paths.title||e.fetchs.paths.label||e.fetchs.paths.id]))]),t._l(e.fetchs.paths.desc,(function(e,s){return[a("span",{key:s,staticClass:"p-1"},[t._v(t._s(n[e]))])]}))],2)})),0)])]):e.items?a("li",{key:s,staticClass:"nav-item dropdown p-1 align-self-center"},[a("a",{staticClass:"btn bg-light d-flex h-100",attrs:{href:"#","data-toggle":"dropdown"}},[a("span",{staticClass:"align-self-center mr-1"},[t._v(t._s(e.label)+":")]),a("span",{staticClass:"align-self-center mr-1"},[t._v(t._s(e.value))]),a("span",{staticClass:"align-self-center fa fa-remove p-1",on:{click:function(e){return e.preventDefault(),t.removeFilter(s)}}})]),a("div",{staticClass:"dropdown-menu",class:{show:e.show}},t._l(e.items,(function(n,i){return a("a",{key:i,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.setFilterValue(s,e,n)}}},[t._v(t._s(n))])})),0)]):a("li",{key:s,staticClass:"nav-item"},[a("a",{staticClass:"btn bg-light",attrs:{href:"#"}},[a("span",{staticClass:"badge badge-light"},[t._v(t._s(e.label))]),t._v(" "+t._s(e.value))])])]})),a("li",{staticClass:"nav-item dropdown flex-grow-1 p-1"},[a("div",{ref:"filterInput",staticClass:"input-group",attrs:{"data-toggle":"dropdown"}},[a("input",{staticClass:"form-control border-0",attrs:{type:"text"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitFilter(e)}}})]),a("div",{staticClass:"dropdown-menu"},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.submitFilter(e)}}},[a("i",{staticClass:"fa fa-search"}),t._v(" 输入回车或点击搜索")]),t.items.length?a("div",{staticClass:"dropdown-divider"}):t._e(),t._l(t.items,(function(e,s){return[t.filters?a("a",{key:s,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.addFilter(e)}}},[e.fa?a("i",{staticClass:"fa",class:e.fa}):t._e(),t._v(" "+t._s(e.label))]):t._e()]}))],2)])],2)])},y=[],_=a("951f"),C=_["a"],k=Object(g["a"])(C,b,y,!1,null,"afb82a92",null),w=k.exports,x={name:"Tables",props:[],data:function(){return{config:null,datas:null,result:null,querys:null}},created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,s,n,i,r,c,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t,!t.$route.query.config){e.next=16;break}return s={},e.prev=3,e.next=6,o.a.get(t.$route.query.config);case 6:s=e.sent,t.config=l.a.merge({},u["a"],s.data||{}),e.next=14;break;case 10:return e.prev=10,e.t0=e["catch"](3),alert("config "+t.$route.query.config+" load error\n"+e.t0.message+" "),e.abrupt("return");case 14:e.next=17;break;case 16:t.config=l.a.merge({},u["a"]);case 17:n=t.$route.query,i=JSON.parse(n.options||{}),r=JSON.parse(n.fetchs||{}),c=JSON.parse(n.columns||[]),f=JSON.parse(n.filters||[]),n.options=l.a.merge({},t.config.options,i),n.fetchs=l.a.merge({},t.config.fetchs,r),n.columns=l.a.map(c,(function(e,s){return"number"===typeof s?"string"===typeof e?a.config.columns[e]:e:l.a.merge({},t.config.columns[s]||{},c[e]?c[e]:{})})),n.filters=l.a.map(f,(function(e,s){return"number"===typeof s?"string"===typeof e?a.config.filters[e]:e:l.a.merge({},t.config.filters[s]||{},f[e]?f[e]:{})})),t.datas=l.a.merge({view:"",title:"",desc:"",fetchs:"{}",columns:"[]",filters:"[]",options:"{}"},n);case 27:case"end":return e.stop()}}),e,null,[[3,10]])})))()},components:{DataTable:v,DataFilter:w}},q=x,D=Object(g["a"])(q,s,n,!1,null,"786bbc1a",null);e["default"]=D.exports},"951f":function(t,e,a){"use strict";(function(t){a("a434"),a("b0c0");var s=a("53ca"),n=a("81b0"),i=a.n(n),r=a("bc3a"),l=a.n(r),c=a("859b");a("d355");function o(t,e){e.fetchs.params[e.fetchs.paths.query]=e.query||"",l()(e.fetchs).then((function(t){var a=e.fetchs.paths.data,s=i.a.get(t.data,a,[]);e.datas=s}))}e["a"]={name:"DataFilter",props:{items:{type:Array,default:function(){return[]}}},data:function(){return{filters:[],value:""}},created:function(){},computed:{jq:function(){return t},fetch:function(){return i.a.debounce(o,500)}},methods:{fetchData:function(t){return this.fetch(this,t)},addFilter:function(t){var e=Object.assign({},t,{show:!0});this.fetchFilter(e),this.filters.push(e)},setFilterValue:function(t,e,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.$set(e,"show",!1),this.$set(e,"value",a),this.$set(e,"text",s)},removeFilter:function(t){this.filters.splice(t,1)},fetchFilter:function(t){if(t.fetchs&&(void 0==t.query||t.query!=t.fetchs.params[t.fetchs.paths.query]))return this.fetchData(t)},submitFilter:function(){this.jq(this.$refs.filterInput).click(),this.buildFilter()},buildFilter:function(){for(var t={},e=0;e<this.filters.length;e++){var a=this.filters[e];"object"==Object(s["a"])(a.value)?t[a.name]=a.value.id:t[a.name]=a.value}this.$emit("update:querys",t)}},components:{Datetime:c["Datetime"]}}}).call(this,a("c5ec"))}}]);
//# sourceMappingURL=chunk-b2347d7e.41463d93fc.js.map